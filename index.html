<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Sobreaviso DRV/DEIC</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: #2563eb; color: white; padding: 30px 20px; text-align: center; }
        .header h1 { font-size: 28px; margin-bottom: 5px; }
        .tabs { display: flex; background: #f0f0f0; border-bottom: 2px solid #ddd; }
        .tab-btn { flex: 1; padding: 15px; border: none; background: none; cursor: pointer; font-size: 16px; font-weight: bold; color: #666; transition: all 0.3s; border-bottom: 3px solid transparent; }
        .tab-btn.active { background: white; color: #2563eb; border-bottom-color: #2563eb; }
        .tab-btn:hover { background: #f9f9f9; }
        .content { padding: 30px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        label { display: block; margin-bottom: 10px; font-weight: bold; color: #333; }
        select, textarea { width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; font-family: Arial, sans-serif; }
        select { cursor: pointer; }
        textarea { height: 350px; resize: vertical; font-family: 'Courier New', monospace; font-size: 13px; }
        .troca-bloco { margin-bottom: 16px; border: 1px solid #eee; border-radius: 6px; padding: 10px; background: #fcfcfc; }
        .buttons { display: flex; gap: 10px; flex-wrap: wrap; }
        button { padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 15px; font-weight: bold; transition: all 0.3s; flex: 1; min-width: 120px; }
        .btn-copy { background: #2563eb; color: white; }
        .btn-copy:hover { background: #1d4ed8; }
        .btn-whatsapp { background: #16a34a; color: white; }
        .btn-whatsapp:hover { background: #15803d; }
        .btn-clear { background: #6b7280; color: white; }
        .btn-clear:hover { background: #4b5563; }
        .btn-troca { background: #ff9800; color: white; }
        .btn-troca:hover { background: #f57c00; }
        @media (max-width: 600px) {
            .header h1 { font-size: 20px; }
            .tabs { flex-direction: column; }
            textarea { height: 250px; }
            button { min-width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã Gerador de Sobreaviso DRV/DEIC</h1>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab(0)">üìÖ Buscar por Data</button>
            <button class="tab-btn" onclick="showTab(1)">üë§ Buscar por Pessoa</button>
            <button class="tab-btn" onclick="showTab(2)">üîÑ Trocas</button>
        </div>

        <div class="content">
            <!-- ABA 1: BUSCAR POR DATA -->
            <div class="tab-content active">
                <label for="date-select">Selecione a data:</label>
                <select id="date-select" onchange="searchByDate()">
                    <option value="">-- Escolha uma data --</option>
                    <option>01/11/2025</option><option>02/11/2025</option><option>03/11/2025</option>
                    <!-- ... todas as datas at√© ... -->
                    <option>31/12/2025</option>
                </select>
            </div>
            <!-- ABA 2: BUSCAR POR PESSOA -->
            <div class="tab-content">
                <label for="person-select">Selecione uma pessoa:</label>
                <select id="person-select" onchange="handlePersonSearch()">
                    <option value="">-- Escolha uma pessoa --</option>
                    <!-- op√ß√µes de pessoas -->
                    <option value="Cau">Insp. Acau√£</option><option value="Saraiva">Esc. Anderson Saraiva</option><option value="Brozoza">Insp. Alexandre Brozoza</option><option value="C√°tia">Esc. C√°tia Fortunato</option><option value="Cristiano">Insp. Cristiano Soletti</option><option value="C√©sar">Esc. C√©sar da Costa</option><option value="Dago">Esc. Dagoberto O. das Virgens</option><option value="Melo">Insp. Edmilson Melo</option><option value="Edna">Insp. Edna Moraes</option><option value="Piazza">Esc. Fernanda Piazza</option><option value="Gui Mello">Insp. Guilherme Mello</option><option value="Jeff">Esc. Jefferson Antoniol</option><option value="Juliana">Insp. Juliana Tremper</option><option value="Bona">Insp. Juliano Bonacina</option><option value="Luciana">Esc. Luciana Bortoli</option><option value="Loss">Insp. Lucas Loss</option><option value="Tais">Insp. Tais Boesing</option><option value="Teresinha">Insp. Teresinha Carivali</option><option value="Thiago">Insp. Thiago Meireles</option><option value="Th√°ssia">Insp. Th√°ssia Guterres</option><option value="Vanessa">Insp. Vanessa Trindade</option>
                </select>
            </div>

            <!-- ABA 3: TROCAS -->
            <div class="tab-content">
                <label for="troca-date">Selecione a data da troca:</label>
                <select id="troca-date">
                    <option value="">-- Escolha uma data --</option>
                    <option>01/11/2025</option>
                    <!-- ... todas as datas at√© ... -->
                    <option>31/12/2025</option>
                </select>
                <!-- Troca 1 -->
                <div class="troca-bloco">
                    <label for="pessoa-original1">Pessoa originalmente escalada (1):</label>
                    <select id="pessoa-original1">
                        <option value="">-- Escolha a pessoa original --</option>
                        <!-- ... pessoas ... -->
                        <option value="Cau">Insp. Acau√£</option><option value="Saraiva">Esc. Anderson Saraiva</option><option value="Brozoza">Insp. Alexandre Brozoza</option><option value="C√°tia">Esc. C√°tia Fortunato</option><option value="Cristiano">Insp. Cristiano Soletti</option><option value="C√©sar">Esc. C√©sar da Costa</option><option value="Dago">Esc. Dagoberto O. das Virgens</option><option value="Melo">Insp. Edmilson Melo</option><option value="Edna">Insp. Edna Moraes</option><option value="Piazza">Esc. Fernanda Piazza</option><option value="Gui Mello">Insp. Guilherme Mello</option><option value="Jeff">Esc. Jefferson Antoniol</option><option value="Juliana">Insp. Juliana Tremper</option><option value="Bona">Insp. Juliano Bonacina</option><option value="Luciana">Esc. Luciana Bortoli</option><option value="Loss">Insp. Lucas Loss</option><option value="Tais">Insp. Tais Boesing</option><option value="Teresinha">Insp. Teresinha Carivali</option><option value="Thiago">Insp. Thiago Meireles</option><option value="Th√°ssia">Insp. Th√°ssia Guterres</option><option value="Vanessa">Insp. Vanessa Trindade</option>
                    </select>
                    <label for="pessoa-troca1">Pessoa que far√° a troca (1):</label>
                    <select id="pessoa-troca1">
                        <option value="">-- Escolha a pessoa substituta --</option>
                        <!-- ... pessoas ... -->
                        <option value="Cau">Insp. Acau√£</option><option value="Saraiva">Esc. Anderson Saraiva</option><option value="Brozoza">Insp. Alexandre Brozoza</option><option value="C√°tia">Esc. C√°tia Fortunato</option><option value="Cristiano">Insp. Cristiano Soletti</option><option value="C√©sar">Esc. C√©sar da Costa</option><option value="Dago">Esc. Dagoberto O. das Virgens</option><option value="Melo">Insp. Edmilson Melo</option><option value="Edna">Insp. Edna Moraes</option><option value="Piazza">Esc. Fernanda Piazza</option><option value="Gui Mello">Insp. Guilherme Mello</option><option value="Jeff">Esc. Jefferson Antoniol</option><option value="Juliana">Insp. Juliana Tremper</option><option value="Bona">Insp. Juliano Bonacina</option><option value="Luciana">Esc. Luciana Bortoli</option><option value="Loss">Insp. Lucas Loss</option><option value="Tais">Insp. Tais Boesing</option><option value="Teresinha">Insp. Teresinha Carivali</option><option value="Thiago">Insp. Thiago Meireles</option><option value="Th√°ssia">Insp. Th√°ssia Guterres</option><option value="Vanessa">Insp. Vanessa Trindade</option>
                    </select>
                </div>
                <!-- Troca 2 -->
                <div class="troca-bloco">
                    <label for="pessoa-original2">Pessoa originalmente escalada (2):</label>
                    <select id="pessoa-original2">
                        <option value="">-- Escolha a pessoa original --</option>
                        <!-- ... pessoas ... -->
                        <option value="Cau">Insp. Acau√£</option><option value="Saraiva">Esc. Anderson Saraiva</option><option value="Brozoza">Insp. Alexandre Brozoza</option><option value="C√°tia">Esc. C√°tia Fortunato</option><option value="Cristiano">Insp. Cristiano Soletti</option><option value="C√©sar">Esc. C√©sar da Costa</option><option value="Dago">Esc. Dagoberto O. das Virgens</option><option value="Melo">Insp. Edmilson Melo</option><option value="Edna">Insp. Edna Moraes</option><option value="Piazza">Esc. Fernanda Piazza</option><option value="Gui Mello">Insp. Guilherme Mello</option><option value="Jeff">Esc. Jefferson Antoniol</option><option value="Juliana">Insp. Juliana Tremper</option><option value="Bona">Insp. Juliano Bonacina</option><option value="Luciana">Esc. Luciana Bortoli</option><option value="Loss">Insp. Lucas Loss</option><option value="Tais">Insp. Tais Boesing</option><option value="Teresinha">Insp. Teresinha Carivali</option><option value="Thiago">Insp. Thiago Meireles</option><option value="Th√°ssia">Insp. Th√°ssia Guterres</option><option value="Vanessa">Insp. Vanessa Trindade</option>
                    </select>
                    <label for="pessoa-troca2">Pessoa que far√° a troca (2):</label>
                    <select id="pessoa-troca2">
                        <option value="">-- Escolha a pessoa substituta --</option>
                        <!-- ... pessoas ... -->
                        <option value="Cau">Insp. Acau√£</option><option value="Saraiva">Esc. Anderson Saraiva</option><option value="Brozoza">Insp. Alexandre Brozoza</option><option value="C√°tia">Esc. C√°tia Fortunato</option><option value="Cristiano">Insp. Cristiano Soletti</option><option value="C√©sar">Esc. C√©sar da Costa</option><option value="Dago">Esc. Dagoberto O. das Virgens</option><option value="Melo">Insp. Edmilson Melo</option><option value="Edna">Insp. Edna Moraes</option><option value="Piazza">Esc. Fernanda Piazza</option><option value="Gui Mello">Insp. Guilherme Mello</option><option value="Jeff">Esc. Jefferson Antoniol</option><option value="Juliana">Insp. Juliana Tremper</option><option value="Bona">Insp. Juliano Bonacina</option><option value="Luciana">Esc. Luciana Bortoli</option><option value="Loss">Insp. Lucas Loss</option><option value="Tais">Insp. Tais Boesing</option><option value="Teresinha">Insp. Teresinha Carivali</option><option value="Thiago">Insp. Thiago Meireles</option><option value="Th√°ssia">Insp. Th√°ssia Guterres</option><option value="Vanessa">Insp. Vanessa Trindade</option>
                    </select>
                </div>
                <!-- Troca 3 -->
                <div class="troca-bloco">
                    <label for="pessoa-original3">Pessoa originalmente escalada (3):</label>
                    <select id="pessoa-original3">
                        <option value="">-- Escolha a pessoa original --</option>
                        <!-- ... pessoas ... -->
                        <option value="Cau">Insp. Acau√£</option><option value="Saraiva">Esc. Anderson Saraiva</option><option value="Brozoza">Insp. Alexandre Brozoza</option><option value="C√°tia">Esc. C√°tia Fortunato</option><option value="Cristiano">Insp. Cristiano Soletti</option><option value="C√©sar">Esc. C√©sar da Costa</option><option value="Dago">Esc. Dagoberto O. das Virgens</option><option value="Melo">Insp. Edmilson Melo</option><option value="Edna">Insp. Edna Moraes</option><option value="Piazza">Esc. Fernanda Piazza</option><option value="Gui Mello">Insp. Guilherme Mello</option><option value="Jeff">Esc. Jefferson Antoniol</option><option value="Juliana">Insp. Juliana Tremper</option><option value="Bona">Insp. Juliano Bonacina</option><option value="Luciana">Esc. Luciana Bortoli</option><option value="Loss">Insp. Lucas Loss</option><option value="Tais">Insp. Tais Boesing</option><option value="Teresinha">Insp. Teresinha Carivali</option><option value="Thiago">Insp. Thiago Meireles</option><option value="Th√°ssia">Insp. Th√°ssia Guterres</option><option value="Vanessa">Insp. Vanessa Trindade</option>
                    </select>
                    <label for="pessoa-troca3">Pessoa que far√° a troca (3):</label>
                    <select id="pessoa-troca3">
                        <option value="">-- Escolha a pessoa substituta --</option>
                        <!-- ... pessoas ... -->
                        <option value="Cau">Insp. Acau√£</option><option value="Saraiva">Esc. Anderson Saraiva</option><option value="Brozoza">Insp. Alexandre Brozoza</option><option value="C√°tia">Esc. C√°tia Fortunato</option><option value="Cristiano">Insp. Cristiano Soletti</option><option value="C√©sar">Esc. C√©sar da Costa</option><option value="Dago">Esc. Dagoberto O. das Virgens</option><option value="Melo">Insp. Edmilson Melo</option><option value="Edna">Insp. Edna Moraes</option><option value="Piazza">Esc. Fernanda Piazza</option><option value="Gui Mello">Insp. Guilherme Mello</option><option value="Jeff">Esc. Jefferson Antoniol</option><option value="Juliana">Insp. Juliana Tremper</option><option value="Bona">Insp. Juliano Bonacina</option><option value="Luciana">Esc. Luciana Bortoli</option><option value="Loss">Insp. Lucas Loss</option><option value="Tais">Insp. Tais Boesing</option><option value="Teresinha">Insp. Teresinha Carivali</option><option value="Thiago">Insp. Thiago Meireles</option><option value="Th√°ssia">Insp. Th√°ssia Guterres</option><option value="Vanessa">Insp. Vanessa Trindade</option>
                    </select>
                </div>
                <button class="btn-troca" onclick="aplicarTrocasMultiplas()">Gerar texto com trocas</button>
            </div>

            <textarea id="output" placeholder="O texto do sobreaviso aparecer√° aqui..." readonly></textarea>

            <div class="buttons">
                <button class="btn-copy" onclick="copyText()">üìã Copiar Texto</button>
                <button class="btn-whatsapp" onclick="sendWhatsApp()">üíö Enviar no WhatsApp</button>
                <button class="btn-clear" onclick="clearAll()">üóëÔ∏è Limpar</button>
            </div>
        </div>
    </div>

    <script>
        // ... cole todo o script daquela vers√£o completa, mantendo os objetos nameMap, phoneMap, schedule, etc!!

        // Substitua a fun√ß√£o aplicarTrocasMultiplas pelo seguinte:

        function aplicarTrocasMultiplas() {
            const date = document.getElementById('troca-date').value;
            // Troca 1
            const original1 = document.getElementById('pessoa-original1').value;
            const substituta1 = document.getElementById('pessoa-troca1').value;
            // Troca 2
            const original2 = document.getElementById('pessoa-original2').value;
            const substituta2 = document.getElementById('pessoa-troca2').value;
            // Troca 3
            const original3 = document.getElementById('pessoa-original3').value;
            const substituta3 = document.getElementById('pessoa-troca3').value;

            const outputElement = document.getElementById('output');
            if (!date) {
                outputElement.value = "Selecione a data.";
                return;
            }
            let escalaAtual = schedule[date] ? [...schedule[date]] : [];
            let trocaFeita = false;

            // Detectar se NAC original est√° vazio e usu√°rio fez uma troca apenas para o NAC
            let nacIndex = 2;  // √≠ndice da NAC na escala
            let nacTroca = false;
            let nacNovo = "";

            // Fun√ß√£o que aplica troca para um par original/substituto, se ambos preenchidos
            function applyExchange(orig, sub) {
                if (!orig || !sub) return false;
                // caso especial para NAC individual
                if ((escalaAtual[nacIndex] === "" || escalaAtual[nacIndex] == null) && orig === "" && sub !== "") {
                    nacTroca = true;
                    nacNovo = sub;
                    return true;
                }
                let did = false;
                for (let i = 0; i < escalaAtual.length; i++) {
                    if (escalaAtual[i] === orig) {
                        escalaAtual[i] = sub;
                        did = true;
                    }
                }
                return did;
            }

            let t1 = applyExchange(original1, substituta1);
            let t2 = applyExchange(original2, substituta2);
            let t3 = applyExchange(original3, substituta3);

            if (nacTroca && !t1 && !t2 && !t3) {
                // S√≥ NAC (sem escala padr√£o)
                const nomeNac = nameMap[nacNovo];
                const foneNac = phoneMap[nacNovo];
                let text = "*Sobreaviso NAC DRV/DEIC*\n";
                text += "Data: " + date + "\n\n";
                text += "NAC: " + nomeNac + "\n" + foneNac + "\n\n";
                outputElement.value = text;
                return;
            }

            if (!t1 && !t2 && !t3 && !nacTroca) {
                outputElement.value = "Nenhuma troca foi realizada. Preencha os campos corretamente!";
                return;
            }
            // Se ocorreu troca normal, mas tamb√©m houve troca de NAC, aplique no array padr√£o
            if (nacTroca) escalaAtual[nacIndex] = nacNovo;
            outputElement.value = buildMessageWithDay(date, escalaAtual);
        }

        // ... as demais fun√ß√µes e objetos do exemplo anterior!
    </script>
</body>
</html>
